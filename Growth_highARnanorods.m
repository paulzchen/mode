%This script solves for theoretical growth kinetics of the high-AR nanorods%from our reactions, based on their proposed modes of growth.%These semi-empirical equations were derived using classical crystal growth %theory (see supplementary text 7). It uses the developed geometric model %(see supplementary text 3) to account for the dimensions of the nanorods %as they grow. The theoretical growth kinetics were compared to the %experimental ones here.%The population of high-AR nanorods emerged from the population of low-AR %nanorods during the reaction (after 35 s). As such, these equations %calculate the theoretical growth kinetics of the high-AR nanorods after%their emergence. The theoretical lengths were taken to be those of the%low-AR nanorods before this emergence time.%For high-AR nanorods, we proposed that growth of nanorod widths (i.e., %{100} side-facets) occurs via the LBL mode, whereas their longitudinal %growth (i.e., in the <100> direction) is mediated by directional %interfacet migration. Unlike for low-AR nanorods, {100}-to-vicinal-to-%{111} adatom migration occurs on high-AR nanorods, supplementing their%longitudinal growth while curbing radial growth (relative to low-AR %nanorods).clcclear allclose all%Anglestheta = 2*pi/5;phi = 0.19588888889*pi;%Geometric parameters (all unitless)A = sqrt( 2 - 2*cos(theta) ); %Lamda, 1st geo. param., angle in radiansk = (5/2)* cos(theta/2); %Kappa, 2nd geo. param.p = (2/3) * tan(phi); %rho, 3rd geo. param.d = 1 / (2 * cos(phi) ); %delta, 4th geo. param. %Constants for calculationsa = 4.085e-10; %lattice parameter {m}y0 = 3*a; %Step-step spacing in vicinal facet {m}v = 1e13; %Vibrational frequency of adatoms {s^-1}v_c = 10.3e-6; %Molar volume {m^3/mol}kB_T = 5.65e-21; %Thermodynamic temperature {J}del_U = 2.474e-20; %Energy of desolvation {J}C0 = 2.86753e-3; %saturation conc. {mM}N0 = 1e19; %Adsorption site density {m^-2}a_del = 1/4; %lattice parameter divided by mean kink spacingdel0 = 1/a_del * a; %mean kink spacing {m}n_NC = 1.25e11; %Number of seeds addedV_s = 18e-3; %Volume of synthesis vial {L}D = 9e-10; %Bulk diffusion coefficient of monomer/precursor {m^2/s}d_ =  125e-9; %thickness of stagnant layer for nanorod vicinal facet (m)d0 = 1/d_;y_a = y0/a;y = 0; %y in the sin^2 term in the equation accounts for the periodicity of the        %step train. Hence, z is modulated to account distance from vicinalk_ = 0.043813; %Boltzmann rate constant {s^-1}t0 = 48.247520; %Boltzmann inflection point {s}A1c = 0.069444; %Max conc. {mM}A2c = C0; %Min conc. {mM}B_st = a* v* a_del* exp(-del_U/ kB_T); %kinetic step coefficientX = (a* B_st* pi* d_)/ (y0* ( pi*D + a*B_st*(pi*d_/y0)) ); %chi term (describes the reaction regime [diffusion vs kinetic])factor = V_s  / (4* pi* n_NC* D* C0 * 1e3); %prefactor before R_conv in                                       %supersaturation calculations {s/mM}%Initialize time arraysn_int = 20; %number of time intervalst_sat = 150; %saturation time for growtht = zeros(n_int + 1 , 1); %time vectort(1) = 50; %Start time of growth calculations for high-AR nanorod lengthst_int = (t_sat-t(1)) / n_int; %time intervalR_conv = zeros(n_int + 1,1); %conversion rate to monomer {mM/s}%experimentally determined width valuest_exp = [10, 15, 20, 35, 50, 65, 95, 130];W_exp = [6.365, 6.300, 6.880, 6.674, 6.877, 7.998, 8.837, 10.116]; %low-AR rodsL_exp = [14.404, 17.503, 24.039, 25.892, 32.313, 38.727, 49.081, 57.763];  %low-AR rodsW_highAR_exp = [6.365, 6.300, 6.880, 6.674, 6.684, 7.424, 7.932, 7.910]; %high-AR rodsL_highAR_exp = [14.404, 17.503, 24.039, 25.892, 57.604, 81.451, 129.476, 186.359]; %high-AR rodst_deca_exp = [0, 10, 15, 20, 35, 50, 65, 95, 130]; %decahedra W_deca_exp = [5.601, 12.369, 14.621, 16.087, 17.879, 20.259, 24.262, 29.403, 33.168]; %decahedra%for supersaturation calculationsr = zeros(n_int,1);W2 = zeros(n_int,1);W2(1) = W_deca_exp(1)*1e-9; r(1) = W2(1)./(1 + cos(theta/2)); du = zeros(n_int,1); %chemical potentialsuper_200ulc = zeros(n_int,1); %bulk supersaturation vectorC_bulk = zeros(n_int,1); %bulk concentration vectorC_st = zeros(n_int,1); %step concentration vectorsuper_st = zeros(n_int,1); %step supersaturation vectorC100 = zeros(n_int,1); %step concentration vector (at 15 nm from vicinal facet)super100 = zeros(n_int,1); %{100} side-facet supersaturation vector du_100 = zeros(n_int,1); %chemical potentialR_LBL = zeros(n_int,1);C_NC = zeros(n_int,1);%Initialize arrays for calculationslength = zeros(n_int + 1 , 1); %length vectorlength(1) = L_exp(5)*1e-9; %Initial length at t = 10 s {m}R_pLBL = zeros(n_int,1);R_highAR = zeros(n_int,1);d2_ =  zeros(n_int + 1 , 1); %thickness of stagnant layer for nanorod side {m}d2_(1) = d_;d2 = W_exp(5)*1e-9; %Initial diameter at t = 10 s {m}r_rod = zeros(n_int,1);r_rod(1) = d2./(1 + cos(theta/2)); %solving for r using d2 = r + r*cos(theta/2)d2_r = zeros(n_int,1); d2_r(1) = d2 - r_rod(1); %Initialize array that accounts for the perpenicular                      %direction to the {100} side-facet, which is specified by                      %"d2 - r", since LBL growth occurs in the direction                      %normal to the facetW_rod2 = zeros(n_int,1);W_rod2(1) = d2; %We specify width as d2 and solve for both using d2 = r + r*cos(theta/2)Area = zeros(n_int,1); %Initialize array for surfae area of {100} side-facetW_highAR = zeros(n_int + 1 , 1); W_highAR(1) = W_highAR_exp(5)*1e-9;r_highAR = zeros(n_int,1);r_highAR(1) = W_highAR(1)./(1 + cos(theta/2)); d2_r_highAR = zeros(n_int,1); d2_r_highAR(1) = W_highAR(1) - r_highAR(1); d2_highAR =  zeros(n_int + 1 , 1); %thickness of stagnant layerlength_highAR = zeros(n_int + 1 , 1); length_highAR(1) = L_highAR_exp(5)*1e-9;Area_highAR = zeros(n_int,1); A_highAR = zeros(n_int,1);B_highAR = zeros(n_int,1);C100_highAR = zeros(n_int,1);super100_highAR = zeros(n_int,1);d2_r_highAR_sim = zeros(n_int,1); d2_r_highAR_sim(1) = d2_r_highAR(1);d2_r_IF = zeros(n_int,1); A_subunit = zeros(n_int,1); d_stag_highAR =  3*d_;d0_highAR = 1/d_stag_highAR;A_ = zeros(n_int,1); %constant A for Chekov's Laplace solutionB_ = zeros(n_int,1); %constant B for Chekov's Laplace solutionz = zeros(n_int,1); %Initialize vector accounting for diffusion field from vicinal facetz(1) = length(1) / 2; %Center of {100} side-facet is taken at half the lengthz_highAR = zeros(n_int,1); %Initialize vector accounting for diffusion field from vicinal facetz_highAR(1) = z(1); %Center of {100} side-facet is taken at half the length                          %for-loop for supersaturation calculationsfor i = 1 : (n_int + 1)  t(i+1) = t(i) + t_int;    C_NC(i) = (A1c - A2c ) - (A1c - A2c)/(1 + exp(k_* (t(i)-t0))); %{mM}    R_conv(i) = ( (A1c - A2c)* k_* exp(k_*(t(i)-t0)) ) / ( 1 + exp(k_*(t(i)-t0)) )^2; %{mM/s}  super_200ulc(i) = log( factor/ 5e-9* R_conv(i) +  1);   C_bulk(i) = C0* exp( super_200ulc(i) ); %bulk concentration    du(i) = C_bulk(i)* kB_T; %bulk chemical potential    R_LBL(i) = v_c* D* C0/r(i)* (exp(super_200ulc(i)) - 1 ); %{m/s}  r(i+1) = r(i) + sqrt(3).* ( R_LBL(i)* t_int ); %update next radius  W2(i+1) = r(i+1).* (1 + cos(theta/2)); %Convert radius (r2) to width (i.e., d2) {nm}  endsuper_200ulc_ave = sum(super_200ulc)/numel(super_200ulc); %Average bulk supersaturationR_DS = 2* D* C0* v_c* d0* y_a* super_200ulc_ave; %Constant rate of vicinal-to-{111} growthR_DS_highAR = R_DS*d0_highAR/d0;%for-loop for width and length calculations, which account for nanorod%dimensionsfor i = 1 : (n_int + 1)  Area(i) = 5* A* r_rod(i)* ( length(i) - 2*r_rod(i)*tan(phi) ); %Calculation of surface                                                         %area of {100} side-                                                         %facet based on                                                          %geometric parameters  Area_highAR(i) =  5* A* r_highAR(i)* ( length_highAR(i) - ...      2*r_highAR(i)*tan(phi) );   A_subunit(i) = (5*A/2)* (r_highAR(i)^2)* cos(theta/2);                                                           z(i) = length(i) / 2;  z_highAR(i) = length_highAR(i) / 2;  d2_(i) = 5*sqrt( z(i)* 1.52e-3/ (0.381* 0.91532e3) ); %stagnant layer thickness for low-AR {m}  d2_highAR(i) = 5*sqrt( z_highAR(i)* 1.52e-3/ (0.381* 0.91532e3) );  %stagnant layer thickness for high-AR {m}    super_st(i) = super_200ulc(i)* (1 - X); %step supersaturation    C_st(i) = C0* exp( super_st(i) ); %step concentration    A_(i) = ( C_bulk(i) - C_st(i) )* y0 / ( pi* d2_(i) );   B_(i) = C_bulk(i) - ( A_(i)* (pi*d2_(i)/y0) );    A_highAR(i) = ( C_bulk(i) - C_st(i) )* y0 / ( pi* d2_highAR(i) );   B_highAR(i) = C_bulk(i) - ( A_(i)* (pi*d2_highAR(i)/y0) );    C100(i) = A_(i)* log( ( (sin(pi*y/y0))^2 + (sinh(pi*z(i)/y0))^2 )^(0.5) ) + B_(i);  super100(i) = log( C100(i)/C0 );   du_100(i) = super_200ulc(i)* kB_T;   C100_highAR(i) = A_highAR(i)* log( ( (sin(pi*y/y0))^2 + ...      (sinh(pi*z_highAR(i)/y0))^2 )^(0.5) ) + B_highAR(i);  super100_highAR(i) = log( C100_highAR(i)/C0 );  R_pLBL(i) = v_c* D* C0/10e-9* (exp(super100(i)) - 1 );   R_highAR(i) = Area_highAR(i)/Area(i)* R_pLBL(i);                                     d2_r(i+1) = d2_r(i) + R_pLBL(i).* t_int; %Update for the next "d2 - r"  r_rod(i+1) = d2_r(i+1) / cos(theta/2); %update next r  W_rod2(i+1) = d2_r(i+1) + r_rod(i+1); %Convert radius (r2) to width (i.e., d2) {m}  length(i+1) = length(i) + ( R_DS*t_int ); %Update length based on constant DS growth rate    d2_r_highAR_sim(i+1) = d2_r_highAR(i) + R_highAR(i).* t_int;   W_highAR(i+1) = (0.0143*t(i+1) + 6.222)*1e-9; %based on linear regression  r_highAR(i+1) = W_highAR(i+1)./(1 + cos(theta/2));  d2_r_highAR(i+1) = W_highAR(i+1) - r_highAR(i+1);  d2_r_IF(i+1) = d2_r_highAR_sim(i+1) - d2_r_highAR(i+1);    if d2_r_IF(i+1) > 0       length_highAR(i+1) = length_highAR(i) + ( R_DS_highAR*t_int ) + ...          ( d2_r_IF(i+1)* Area_highAR(i) )/ ( A_subunit(i) );  else      length_highAR(i+1) = length_highAR(i) + ( R_DS_highAR*t_int );  end endlength_nm = length.*1e9; %{nm}W2_rod_nm = W_rod2.* 1e9; %{nm}W2_nm = W2.* 1e9; %{nm}t_ = [10:1:150]; %full time span for the fitted empirical widthW_highAR_nm = (0.0143.*t_ + 6.222); %fitted empirical widthL_highAR_nm = length_highAR.*1e9; %{nm}figuresubplot(1,2,1)plot(t_,W_highAR_nm,'r','LineWidth',2)hold onscatter(t_exp,W_highAR_exp,40,'r')hold offlegend('Fit','Exp.')xlabel('Time (s)')ylabel('High-AR nanorod width (nm)')subplot(1,2,2)plot(t(2:n_int+1),L_highAR_nm(2:n_int+1),'r','LineWidth',2)xlabel('Time (s)')ylabel('High-AR nanorod length (nm)')hold onscatter(t_exp,L_highAR_exp,40,'r')legend('Theor.','Exp.')hold off