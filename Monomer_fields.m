%This script solves for the monomer diffusion fields surrounding the %vicinal facets of our nanorods during the growth reaction.%Monomer concentrations were calculated from the semicylindrical form of %the Laplace equation in classical crystal growth theory (see supplementary%text 6)clcclear allclose all%Anglestheta = 2*pi/5;phi = 0.19588888889*pi;%Geometric parameters (all unitless)A = sqrt( 2 - 2*cos(theta) ); %Lamda, 1st geo. param., angle in radiansk = (5/2)* cos(theta/2); %Kappa, 2nd geo. param.p = (2/3) * tan(phi); %rho, 3rd geo. param.d = 1 / (2 * cos(phi) ); %delta, 4th geo. param. %Constants for calculationsa = 4.085e-10; %lattice parameter {m}y0 = 3*a; %Step-step spacing in vicinal facet {m}d_ =  125e-9; %thickness of stagnant layer for nanorod vicinal facet {m}d0 = 1/d_;y_a = y0/a;y = 0; %y in the sin^2 term in the equation accounts for the periodicity of the        %step train. Hence, z is modulated to account distance from vicinal              v = 1e13; %Vibrational frequency of adatoms {s^-1}v_c = 10.3e-6; %Molar volume {m^3/mol}kB_T = 5.65e-21; %Thermodynamic temperature {J}del_U = 2.474e-20; %Energy of desolvation {J}C0 = 2.86753e-3; %saturation conc. {mM}N0 = 1e19; %Adsorption site density {m^-2}a_del = 1/2; %lattice parameter divided by mean kink spacingdel0 = 1/a_del * a; %mean kink spacing {m}n_NC = 1.25e11; %Number of seeds addedV_s = 18e-3; %Volume of synthesis vial {L}D = 9e-10; %Bulk diffusion coefficient of monomer/precursor {m^2/s}k_ = 0.043813; %Boltzmann rate constant {s^-1}t0 = 48.247520; %Boltzman inflection point point {s}A1c = 0.069444; %Max conc. {mM}A2c = C0; %Min conc. {mM}B_st = a* v* a_del* exp(-del_U/ kB_T); %kinetic step coefficientX = (a* B_st* pi* d_)/ (y0* ( pi*D + a*B_st*(pi*d_/y0)) ); %chi term (describes the reaction regime [diffusion vs kinetic])factor = V_s  / (4* pi* n_NC* D* C0 * 1e3); %prefactor before R_conv in                                     %supersaturation calculations {s/mM}%Initialize time arraysn_int = 200; %number of time intervalst_sat = 150; %saturation time for growtht = zeros(n_int + 1 , 1); %time vectort(1) = 10; %Start time of growth calculations at 10 s (based on initial length)t_int = (t_sat-t(1)) / n_int; %time intervalR_conv = zeros(n_int + 1,1); %conversion rate to monomer {mM/s}%experimentally determined width valuest_exp = [10, 15, 20, 35, 50, 65, 95, 130];W_exp = [6.365, 6.300, 6.880, 6.674, 6.877, 7.998, 8.837, 10.116]; %low-AR rodsL_exp = [14.404, 17.503, 24.039, 25.892, 32.313, 38.727, 49.081, 57.763];  %low-AR rodsW_highAR_exp = [6.365, 6.300, 6.880, 6.674, 6.684, 7.424, 7.932, 7.910]; %high-AR rodsL_highAR_exp = [14.404, 17.503, 24.039, 25.892, 57.604, 81.451, 129.476, 186.359]; %high-AR rodst_deca_exp = [0, 10, 15, 20, 35, 50, 65, 95, 130]; %decahedra W_deca_exp = [5.601, 12.369, 14.621, 16.087, 17.879, 20.259, 24.262, 29.403, 33.168]; %decahedra%Initialize supersaturation arraysC_NC = zeros(n_int,1); %NC conversion vectorsuper_200ulc = zeros(n_int,1); %bulk supersaturation vectorC_bulk = zeros(n_int,1); %bulk concentration vectorC_st = zeros(n_int,1); %step concentration vectorsuper_st = zeros(n_int,1); %step supersaturation vectorr = zeros(n_int,1);W2 = zeros(n_int,1);W2(1) = W_deca_exp(1)*1e-9; %solving for r using d2 = r + r*cos(theta/2)r(1) = W2(1)./(1 + cos(theta/2)); %solving for r using d2 = r + r*cos(theta/2)du = zeros(n_int,1); %chemical potentialR_LBL = zeros(n_int,1);z_ = [1:0.25:100]'*1e-9; %Distances for semicylindrical surface of diffusion field {nm}C_z = zeros(n_int,length(z_)); %Array of monomer concentrationssuper_z = zeros(n_int,length(z_)); %Array of effective supersaturations%for-loop for width and length calculations, which account for nanorod%dimensionsfor i = 1 : (n_int + 1)  t(i+1) = t(i) + t_int;  C_NC(i) = (A1c - A2c ) - (A1c - A2c)/(1 + exp(k_* (t(i)-t0))); %{mM}  R_conv(i) = ( (A1c - A2c)* k_* exp(k_*(t(i)-t0)) ) / ( 1 + exp(k_*(t(i)-t0)) )^2; %{mM/s}  super_200ulc(i) = log( factor/ 5e-9* R_conv(i) +  1);  C_bulk(i) = C0* exp( super_200ulc(i) ); %bulk concentration   du(i) = C_bulk(i)* kB_T; %bulk chemical potential  R_LBL(i) = v_c* D* C0/r(i)* (exp(super_200ulc(i)) - 1 ); %{m/s}  r(i+1) = r(i) + sqrt(3).* ( R_LBL(i)* t_int ); %update next radius  W2(i+1) = r(i+1).* (1 + cos(theta/2)); %Convert radius (r2) to width (i.e., d2) {nm}end%for-loop for width and length calculationsfor i = 1 : (n_int + 1)    super_st(i) = super_200ulc(i)* (1 - X); %step supersaturation      C_st(i) = C0* exp( super_st(i) ); %step concentration        for j = 1 : length(z_)        C_z(i,j) = y0/(pi*d_)* ( C_bulk(i) - C_st(i) )*...            log( (sinh(pi*z_(j)/y0))) + C_st(i);        super_z(i,j) = log(C_z(i,j)/C0);    endendsubplot(2,2,1)plot(z_,C_z(10,:),'LineWidth',2)xlabel('Distance from vicinal (m)')hold onscatter(z_,C0,'x')scatter(z_,C_bulk(10),'x')hold offylabel('Effective monomer conc.')legend('Effective conc.','Saturation conc.','Bulk conc.')title('Time point = 10')subplot(2,2,2)plot(z_,super_z(10,:),'LineWidth',2)xlabel('Distance from vicinal (m)')hold onscatter(z_,super_200ulc(10),'x')hold offylabel('Effective supersaturation')legend('Effective supersaturation','Bulk supersaturation')title('Time point = 10')subplot(2,2,3)plot(z_,C_z(70,:),'LineWidth',2)xlabel('Distance from vicinal (m)')hold onscatter(z_,C0,'x')scatter(z_,C_bulk(70),'x')hold offylabel('Effective monomer conc.')legend('Effective conc.','Saturation conc.','Bulk conc.')title('Time point = 70')subplot(2,2,4)plot(z_,super_z(70,:),'LineWidth',2)xlabel('Distance from vicinal (m)')hold onscatter(z_,super_200ulc(70),'x')title('Time point = 70')hold offylabel('Effective supersaturation')legend('Effective supersaturation','Bulk supersaturation')