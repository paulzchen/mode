%This script solves for the relative and absolute temporal profiles of the%supersaturation dynamics in the seed-mediated synthesis of our colloidal %Au nanorods.clcclear allclose all%Constants for calculationsC_inf = 2.86753e-3 ; %saturation conc. {mM}C0 = 0.0694; %total added monomer conc. {mM}v = 1e13; %Vibrational frequency of adatoms {s^-1}v_c = 10.3e-6; %Molar volume of Au atom in crystal {m^3/mol}kB_T = 4.11e-21; %Thermodynamic temperature {J}n_NC = 1.25e11; %No. of seeds addedV_s = 18e-3; %Volume of synthesis vial {L}D = 9e-10; %Bulk diffusion coefficient of monomer/precursor {m^2/s}factor = V_s  / (4* pi* n_NC* D* C_inf * 1e3); %prefactor before r_conv%Parameters from Boltzmann fitsA1c = [C0, C0*(0.24812/0.25), C0*(0.24664/0.25), C0*(0.24643/0.25)]'; %total added precursor conc. {mM} A2c = [C_inf, C_inf, C_inf, C_inf]'; %min precursor conc. {mM}k = [0.043813, 0.055510, 0.081640, 0.121670]'; %{s^-1}t0 = [48.247520, 34.901120, 24.206530, 15.981180]'; %{s}%Time range and initialize arraysn_sample = length(k); %samples in this scriptn_int = 1000; %number of time intervalst_sat = 160; %saturation time for growtht_int = t_sat / n_int; %time intervalt = zeros(n_int + 1 , 1); %time vectorln_super = zeros(n_int + 1,n_sample); %supersaturation matrix (each column is a sample)                                      %calculated with the natural log                                      %formulaR_conv = zeros(n_int + 1,n_sample); %conversion rate to monomer (mM/s)%Calculate supersaturation profilesfor i = 1 : n_int + 1    t(i+1) = t(i) + t_int;    for j = 1 : n_sample        R_conv(i,j) = ( (A1c(j) - A2c(j))* k(j)* exp(k(j)*(t(i)-t0(j))) ) / ...            ( 1 + exp(k(j)*(t(i)-t0(j))) )^2; %{mM/s}        ln_super(i,j) = log( factor/ 5e-9* R_conv(i,j) + 1 );    endend%Relative supersaturation profilesmax_super = max(max(ln_super)); %Peak supersaturation over all samples (scaling factor)ln_super_p = ln_super./max_super*100; %{%}subplot(1,2,1)scatter(t(1:n_int+1),ln_super,40)title('supersaturation dynamics')xlabel('time (s)')ylabel('supersaturation')legend('160 equiv HCl','120 equiv HCl','80 equiv HCl', '40 equiv HCl')subplot(1,2,2)scatter(t(1:n_int+1),ln_super_p,40)title('Relative supersaturation dynamics')xlabel('time (s)')ylabel('supersaturation (%)')legend('160 equiv HCl','120 equiv HCl','80 equiv HCl', '40 equiv HCl')